@using AntDesign
@using Microsoft.AspNetCore.Components
@using Microsoft.AspNetCore.Components.Routing
@using Microsoft.AspNetCore.Components.Web

<CascadingValue Value="this" IsFixed>
    <ConfigProvider>
        <Router AppAssembly="@typeof(App).Assembly">
            <Found Context="routeData">
                @if (CascadingRouteData)
                {
                    <CascadingValue Value="routeData">
                        <RouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)" />
                    </CascadingValue>
                }
                else
                {
                    <RouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)" />
                }

                <FocusOnNavigate RouteData="@routeData" Selector="h1" />
            </Found>
            <NotFound>
                <PageTitle>Not found</PageTitle>
                <LayoutView Layout="@typeof(MainLayout)">
                    <p role="alert">Sorry, there's nothing at this address.</p>
                </LayoutView>
            </NotFound>
        </Router>

        <AntContainer />
    </ConfigProvider>
</CascadingValue>

@code {
    /// <summary>是否向外层布局传递路由数据。</summary>
    public bool CascadingRouteData { get; private set; } = true;

    /// <summary>切换路由数据级联状态。</summary>
    /// <param name="enable">是否启用级联。</param>
    public void SetCascadingRouteData(bool enable)
    {
        if (CascadingRouteData == enable)
        {
            return;
        }

        CascadingRouteData = enable;
        StateHasChanged();
    }
}
