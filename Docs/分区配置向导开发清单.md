# 分区配置向导开发剩余清单

> 说明：以下任务基于当前已完成的工作（元数据查询 API、连接工厂扩展等）整理。列表按模块拆分，便于迭代跟踪。

## 一、后端（Domain / Application / API）
1. **PartitionConfiguration 领域扩展**
   - [x] 支持存放模式、文件目录、文件大小、目标表名、备注等属性。
   - [x] 增加必要的业务规则：目标表命名校验、单文件组参数验证、分区列 NOT NULL 要求等。
2. **应用服务**
   - [x] 新增 `PartitionConfigurationAppService`，实现创建配置、添加分区值等用例。
   - [x] 输出 `CreatePartitionConfigurationRequest` / `ReplacePartitionValuesRequest` DTO，封装校验结果。
3. **API 控制器**
   - [x] 新建 `PartitionConfigurationsController` 暴露创建/更新接口。
   - [x] 返回标准 `Result` 响应，覆盖失败场景提示。

## 二、基础设施（Infrastructure）
1. **数据持久化**
   - [x] 更新 EF 实体与 DbContext 映射，补充新字段。
   - [x] 编写数据库迁移脚本（新增表/字段：PartitionConfigurations、PartitionValues 等）。
2. **SQL 资源**
   - [ ] 根据选择的存放模式，生成文件组/数据文件创建语句模板（参考最佳实践文档）。
   - [x] 记录默认目录获取逻辑在文档中说明。

## 三、前端（Blazor Web）
1. **页面结构**
   - [x] 将分区配置向导实现为抽屉 + Steps（基础信息 / 分区值）。
   - [x] 处理表选择、列信息加载、列统计展示、目标库下拉等交互。
2. **校验与提示**
   - [x] 实现多步骤校验（必选项、格式、文件大小、分区值排序等）。
   - [x] 提供错误提示和加载状态反馈。
3. **提交逻辑**
   - [x] 调用新建配置 / 保存分区值 API，处理成功与失败的 UI 状态。
4. **样式补充**
   - [x] 为向导新增 CSS（布局、list、按钮区域等），保持现有主题风格。

## 四、测试
1. **单元测试**
   - [x] 领域模型与应用服务校验逻辑覆盖（分区列、存放模式、目标表命名等）。
2. **集成测试**
   - [ ] 新增 API 测试：创建配置、添加分区值成功/失败路径。
3. **前端测试（可选）**
   - [ ] bUnit 组件测试或 Playwright 自动化（至少覆盖关键交互）。

## 五、文档与交付
1. **Docs 更新**
   - [x] 在《分区管理功能设计》补充向导实际实现细节、配置示例、脚本说明。
   - [ ] 生成面向用户的向导使用手册（截图 + 步骤）。
2. **README/变更记录**
   - [ ] 在 README 的“功能规划” / “当前进度”更新分区配置里程碑。
3. **部署检查**
   - [x] 评估数据库迁移和配置变更的发布步骤，更新部署清单（迁移脚本随代码交付，部署手册待补充截图）。

--- 

如需按 Sprint 拆分，可优先完成后端接口与前端基础交互，再逐步引入校验、脚本生成与测试用例。任务执行过程中若新增依赖（例如脚本模板），请同步调整本清单。*** End Patch
