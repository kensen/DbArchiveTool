# 修复记录 - 归档任务监控页面

## 问题

1. **错误**: `InvalidOperationException: Object of type 'AntDesign.ProLayout.PageContainer' does not have a property matching the name 'Description'.`
2. **缺失**: 主界面菜单中没有"归档任务"链接

## 根本原因

1. **PageContainer 组件不支持 `Description` 属性**
   - 项目使用的 `AntDesign.ProLayout.PageContainer` 版本只支持 `Title` 和 `Extra` 等属性
   - 我错误地添加了 `Description` 属性

2. **菜单在 MainLayout.razor 中**
   - 项目使用自定义的 `MainLayout.razor` 而非 `NavMenu.razor`
   - 我之前修改了错误的文件

## 修复方案

### 1. 移除不支持的 Description 属性

**文件**: `src/DbArchiveTool.Web/Pages/ArchiveJobs.razor`

```razor
<!-- 修复前 -->
<PageContainer Title="归档任务监控" Description="实时监控归档任务执行状态(Hangfire)">

<!-- 修复后 -->
<PageContainer Title="归档任务监控">
```

### 2. 在 MainLayout.razor 中添加菜单项

**文件**: `src/DbArchiveTool.Web/Shared/MainLayout.razor`

在 `日志审计` 菜单项后添加:

```razor
<MenuItem Key="/archive-jobs" OnClick="@(() => NavigateTo("/archive-jobs"))">
    <Icon Type="clock-circle" />
    归档任务
</MenuItem>
```

同时移除了原有的禁用菜单项:
```razor
<!-- 已移除 -->
<MenuItem Key="/tasks" Disabled>
    <Icon Type="file-text" />
    归档任务（规划中）
</MenuItem>
```

## 验证

✅ 编译成功,无错误
✅ 菜单项已添加到主界面
✅ 页面路由 `/archive-jobs` 可访问

## 菜单结构

更新后的主菜单结构:

```
数据库归档工具
├── 数据源管理
│   └── 数据源配置 (/)
├── 任务调度 (/background-tasks/monitor)
├── 日志审计 (/audit-logs)
└── 归档任务 (/archive-jobs) [新增]
```

## 注意事项

1. **NavMenu.razor 未使用**: 项目中的 `NavMenu.razor` 文件实际上未被 `MainLayout.razor` 引用,所以对它的修改不会生效

2. **图标选择**: 使用 `clock-circle` 图标表示归档任务(与时间/调度相关)

3. **路由配置**: 页面路由 `@page "/archive-jobs"` 已在 `ArchiveJobs.razor` 中配置

## 测试步骤

1. 启动 Web 应用:
   ```bash
   cd src/DbArchiveTool.Web
   dotnet run
   ```

2. 打开浏览器访问应用

3. 在左侧菜单中点击"归档任务"

4. 验证页面正常加载,显示:
   - 统计卡片(6个)
   - 任务列表标签页
   - 定时任务标签页

## 已修复的文件

- ✅ `src/DbArchiveTool.Web/Pages/ArchiveJobs.razor`
- ✅ `src/DbArchiveTool.Web/Shared/MainLayout.razor`
